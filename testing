export const ecommerceE2E = async (req, res, next) => {
  console.log("executing");

  exec("npx playwright test", { timeout: 120000 }, async (error) => {
    try {
      const files = videoPicsResult();
      const urlPath = reportUrl();

      const uploadedVideo = await cloudinaryUploaderVideo(
        files.videoPathAbsolute,
        "playwright-results"
      );
      const uploadedScreenshot = await cloudinaryUploader(
        files.screenshotPathAbsolute,
        "playwright-results"
      );
      if (error) {
        //gather video and picture url here
        const files = videoPicsResult();

        return res.json({
          status: "failed",
          urlPath,
          message: error.message,
          videoUrl: files.videoPathAbsolute,
          pictureUrl: files.screenshotPathAbsolute,
        });
      }

      return res.json({
        status: "passed",
        urlPath,
        videoUrl: uploadedVideo.secure_url,
        screenshotUrl: uploadedScreenshot.secure_url,
      });
    } catch (error) {
      console.error(error.message, "is the error happened at e2e endpoint");
      throw error;
    }

  });
};
